(this.webpackJsonpsmartfarm=this.webpackJsonpsmartfarm||[]).push([[0],{103:function(e,t,a){},135:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(17),i=a.n(r),l=(a(87),a(10)),o=a(11),c=a(13),u=a(12),m=a(9),d=a(139),p=a(140),g=a(62),v=a(141),h=a(142),f=a(145);function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m";return{item:e,mo:t}}var y={addOuter:function(e){var t={};return t["KS-X-3267:2021"]=e,t},getCommSpec:function(e,t,a){var n={},s={},r=null;return null===e||null===t?null:("node"===e&&(s["starting-register"]=201,s.items=[E("status")],"level0"===a?r=null:"level1"==a&&(s.items.push(E("opid")),s.items.push(E("control")),(r={})["starting-register"]=301,r.items=[E("operation"),E("opid"),E("control")])),"sensor"===e&&("temperature-sensor"===t?s["starting-register"]=202:"humidity-sensor"===t?s["starting-register"]=205:"CO2-sensor"===t?s["starting-register"]=208:"pyranometer-sensor"===t?s["starting-register"]=211:"wind-direction-sensor"===t?s["starting-register"]=214:"wind-speed-sensor"===t?s["starting-register"]=217:"rain-detector-sensor"===t?s["starting-register"]=220:"quantum-sensor"===t?s["starting-register"]=223:"soil-moisture-sensor"===t?s["starting-register"]=226:"tensiometer-sensor"===t?s["starting-register"]=229:"EC-sensor"===t?s["starting-register"]=232:"pH-sensor"===t?s["starting-register"]=235:"soil-temperature-sensor"===t?s["starting-register"]=238:"flow-sensor"===t?s["starting-register"]=241:"voltage-sensor"===t?s["starting-register"]=244:"current-sensor"===t&&(s["starting-register"]=247),s.items=[E("value"),E("status")]),"actuator"===e&&(s["starting-register"]=208,"retractable"===t?(s.items=[E("status")],"level0"===a?((r={})["starting-register"]=212,r.items=[E("operation")]):"level1"===a?(s.items.push(E("opid")),s.items.push(E("state-hold-time","o")),s.items.push(E("position","o")),s.items.push(E("remain-time")),(r={})["starting-register"]=212,r.items=[E("operation"),E("opid"),E("time")]):"level2"===a&&(s.items.push(E("opid")),s.items.push(E("state-hold-time","o")),s.items.push(E("position")),s.items.push(E("remain-time")),s.items.push(E("opentime")),s.items.push(E("closetime")),(r={})["starting-register"]=311,r.items=[E("operation"),E("opid"),E("time"),E("position"),E("opentime"),E("closetime")])):"switch"===t?(s.items=[E("opid")],"level0"===a?((r={})["starting-register"]=311,r.items=[E("operation")]):"level1"===a?(s.items.push(E("opid")),s.items.push(E("state-hold-time","o")),s.items.push(E("remain-time")),(r={})["starting-register"]=311,r.items=[E("operation"),E("opid"),E("hold-time")]):"level2"===a&&(s.items.push(E("opid")),s.items.push(E("state-hold-time","o")),s.items.push(E("ratio")),s.items.push(E("remain-time")),(r={})["starting-register"]=311,r.items=[E("operation"),E("opid"),E("hold-time"),E("ratio")])):"nutrient-supply"===t&&(s.items=[E("status"),E("area"),E("alert")],"level0"!==a&&null!=a&&(s.items.push(E("opid")),(r={})["starting-register"]=311,r.items=[E("operation"),E("opid")]),"level2"===a?(r.items.push(E("on-sec")),r.items.push(E("start-area")),r.items.push(E("stop-area"))):"level3"===a&&(r.items.push(E("on-sec")),r.items.push(E("start-area")),r.items.push(E("stop-area")),r.items.push(E("EC")),r.items.push(E("pH"))))),"misc"===e&&("display"===t?(s["starting-register"]=301,s.items=[E("status"),E("opid")],(r={})["starting-register"]=401,r.items=[E("operation"),E("opid"),E("epoch"),E("vfloat"),E("vint")]):s=null),null!==s&&(n.read=s),null!==r&&(n.write=r),n)}},S=[{Class:"node",Type:"sensor-node/level1",Operations:[{Operation:"reset",Value:1}]},{Class:"node",Type:"actuator-node/level1",Operations:[{Operation:"reset",Value:1}]},{Class:"node",Type:"actuator-node/level2",Operations:[{Operation:"reset",Value:1},{Operation:"control",Value:2,Parameters:[{Parameter:"control",MO:"m",type:"uint16"}]}]},{Class:"node",Type:"integrated-node/level1",Operations:[{Operation:"reset",Value:1}]},{Class:"node",Type:"integrated-node/level2",Operations:[{Operation:"reset",Value:1},{Operation:"control",Value:2,Parameters:[{Parameter:"control",MO:"m",type:"uint16"}]}]},{Class:"actuator",Type:"retractable/level0",Operations:[{Operation:"open",Value:301},{Operation:"close",Value:302},{Operation:"stop",Value:0}]},{Class:"actuator",Type:"retractable/level1",Operations:[{Operation:"open",Value:301},{Operation:"close",Value:302},{Operation:"stop",Value:0},{Operation:"timed-open",Value:303,Parameters:[{Parameter:"time",MO:"m",type:"uint32"}]},{Operation:"timed-close",Value:304,Parameters:[{Parameter:"time",MO:"m",type:"uint32"}]}]},{Class:"actuator",Type:"retractable/level2",Operations:[{Operation:"open",Value:301},{Operation:"close",Value:302},{Operation:"stop",Value:0},{Operation:"timed-open",Value:303,Parameters:[{Parameter:"time",MO:"m",type:"uint32"}]},{Operation:"timed-close",Value:304,Parameters:[{Parameter:"time",MO:"m",type:"uint32"}]},{Operation:"set-position",Value:305,Parameters:[{Parameter:"position",MO:"m",type:"uint16"}]},{Operation:"set-config",Value:306,Parameters:[{Parameter:"opentime",MO:"m",type:"uint16"},{Parameter:"closetime",MO:"m",type:"uint16"}]}]},{Class:"actuator",Type:"switch/level0",Operations:[{Operation:"on",Value:201},{Operation:"off",Value:0}]},{Class:"actuator",Type:"switch/level1",Operations:[{Operation:"on",Value:201},{Operation:"off",Value:0},{Operation:"timed-on",Value:202,Parameters:[{Parameter:"hold-time",MO:"m",type:"uint16"}]}]},{Class:"actuator",Type:"switch/level2",Operations:[{Operation:"on",Value:201},{Operation:"off",Value:0},{Operation:"timed-on",Value:202,Parameters:[{Parameter:"hold-time",MO:"m",type:"uint16"}]},{Operation:"directional-on",Value:203,Parameters:[{Parameter:"hold-time",MO:"m",type:"uint16"},{Parameter:"ratio",MO:"m",type:"int16"}]}]}],w=["node","sensor","actuator","misc"],C={node:["sensor-node","actuator-node","integrated-node"],sensor:["temperature-sensor","humidity-sensor","CO2-sensor","pyranometer-sensor","wind-direction-sensor","wind-speed-sensor","rain-detector-sensor","quantum-sensor","soil-moisture-sensor","tensiometer-sensor","EC-sensor","pH-sensor","soil-temperature-sensor","flow-sensor","voltage-sensor","current-sensor","rain-gauge-sensor","weight-sensor"],actuator:["retractable","switch","nutrient-supply"],misc:["display"]};var x={sensor_node:["level0"],actuator_node:["level0","level1"],integrated_node:["level0","level1"],retractable:["level0","level1","level2"],switch:["level0","level1","level2"],nutrient_supply:["level0","level1","level2","level3"]};var O=[1,2,3,4,5,6,7,8,9,10,11,14,15,16,17,"etc"],b=["None","0",1,2,3,4,5,6,7,8,9,10];function D(e){var t=null;if(e){var a=e["KS-X-3267:2021"];if(void 0===a&&null===a)return null;t={},a.read&&(t.read=a.read.items),a.write&&(t.write=a.write.items)}return t}function T(e,t){var a=new String(t);if(!(a.indexOf("/")>0))return"";a=a.split("/")[0];var n=x[a.replace("-","_")];return n&&n.length>0?n[n.length-1]:""}function M(e){var t=null;if(e){var a=e.Class,n=new String(e.Type),s=T(0,n);n.indexOf("/")>0&&(n=n.split("/")[0]);var r=y.getCommSpec(a,n,s);if(void 0===r&&null===r)return null;t={},r.read&&(t.read=[],r.read.items.map((function(e){t.read.push(e.item)}))),r.write&&(t.write=[],r.write.items.map((function(e){t.write.push(e.item)})))}return t}function k(e,t){for(var a=0;a<S.length;a++){var n=S[a];if(n.Class===e&&n.Type===t)return n.Operations}return null}function R(e,t){var a=new String(t);a.indexOf("/")>0&&(a=a.split("/")[0]),a+="/"+T(0,t);for(var n=0;n<S.length;n++){var s=S[n];if(s.Class===e&&s.Type===a)return s.Operations}return null}a(88);var I=document.createElement("li");I.className="itemM";var L=0,F=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={readStartingRegister:"",writeStartingRegister:"",readItems:null,writeItems:null,savedCommSpec:null,refresh:1},n.updateCommSpec=function(){n.commSpec=y.getCommSpec(n.props.cls,n.props.type,n.props.subtype),n.commSpec?n.setState({readStartingRegister:n.commSpec.read["starting-register"]||"",writeStartingRegister:n.commSpec.write&&n.commSpec.write["starting-register"]||"",readItems:n.commSpec.read.items,writeItems:n.commSpec.write?n.commSpec.write.items:null},(function(){n.state.savedCommSpec&&n.matchCommSpec(n.state.savedCommSpec),n.props.onChanged()})):n.setState({readStartingRegister:"",writeStartingRegister:"",readItems:null,writeItems:null},(function(){n.props.onChanged()}))},n.getCommSpec=function(){if(!n.commSpec)return null;var e=[],t=[];return null===n.state.readItems?null:(n.state.readItems.map((function(t){return"x"!==t.mo&&e.push(t.item),null})),null!=n.state.readStartingRegister&&n.state.readStartingRegister>0?n.commSpec.read["starting-register"]=n.state.readStartingRegister:(n.commSpec.read["starting-register"]=void 0,delete n.commSpec.read["starting-register"]),n.state.writeItems&&n.state.writeItems.map((function(e){return"x"!==e.mo&&t.push(e.item),null})),n.commSpec.read.items=e,n.commSpec.write&&(n.commSpec.write.items=t,null!=n.state.writeStartingRegister&&n.state.writeStartingRegister>0?n.commSpec.write["starting-register"]=n.state.writeStartingRegister:(n.commSpec.write["starting-register"]=void 0,delete n.commSpec.write["starting-register"])),y.addOuter(n.commSpec))},n.setCommSpec=function(e){n.setState({savedCommSpec:e})},n.matchCommSpec=function(e){if(e){var t=e["KS-X-3267:2021"].read,a=e["KS-X-3267:2021"].write,s=null,r=null;t&&(n.setState({readStartingRegister:t["starting-register"]}),s=[],n.state.readItems&&(t.items.map((function(e){for(var t=-1,a=0;a<n.state.readItems.length;a++){if(n.state.readItems[a].item===e){t=a;break}}return t>=0&&s.push(n.state.readItems[t]),null})),n.state.readItems.map((function(e){return t.items.indexOf(e.item)<0&&"o"===e.mo&&(e.mo="x",s.push(e)),null})))),a&&(n.setState({writeStartingRegister:a["starting-register"]}),r=[],n.state.writeItems&&(a.items.map((function(e){for(var t=-1,a=0;a<n.state.writeItems.length;a++){if(n.state.writeItems[a].item===e){t=a;break}}return t>=0&&r.push(n.state.writeItems[t]),null})),n.state.writeItems.map((function(e){return a.items.indexOf(e.item)<0&&"o"===e.mo&&(e.mo="x",r.push(e)),null})))),n.setState({readItems:s,writeItems:r},(function(){n.props.onChanged()}))}},n.readStartingVal=function(e){if(null==e.target.value||e.target.value.length<=0)n.setState({readStartingRegister:null},(function(){n.props.onChanged()}));else{var t=parseInt(e.target.value);t&&n.setState({readStartingRegister:t},(function(){n.props.onChanged()}))}},n.writeStartingVal=function(e){if(null==e.target.value||e.target.value.length<=0)n.setState({writeStartingRegister:null},(function(){n.props.onChanged()}));else{var t=parseInt(e.target.value);t&&n.setState({writeStartingRegister:t},(function(){n.props.onChanged()}))}},n.optionBtn=function(e,t){"o"===t.mo?t.mo="x":t.mo="o",n.setState({refresh:1}),n.props.onChanged()},n.dragStart=function(e){n.dragged=e.currentTarget,n.dragged.style.backgroundColor="darkgray",e.currentTarget.parentNode.appendChild(I)},n.dragOver=function(e){e.preventDefault(),e.target!==n.dragged&&"LI"===e.target.tagName&&e.target.parentNode===n.dragged.parentNode&&(n.over=e.target,e.target.parentNode.insertBefore(n.dragged,e.target))},n.readDragEnd=function(e){n.dragEnd(n.state.readItems),n.setState({readItems:n.state.readItems},(function(){n.props.onChanged()}))},n.writeDragEnd=function(e){n.dragEnd(n.state.writeItems),n.setState({writeItems:n.state.writeItems},(function(){n.props.onChanged()}))},n.dragEnd=function(e){if(n.dragged.style.backgroundColor=null,n.dragged.parentNode.removeChild(I),n.over.dataset.id){var t=Number(n.dragged.dataset.id),a=Number(n.over.dataset.id);t<a&&a--,e.splice(a,0,e.splice(t,1)[0])}else{var s=e[n.dragged.dataset.id];e.splice(n.dragged.dataset.id,1),e.push(s)}},n.commSpec=null,n.result=null,n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.updateCommSpec()}},{key:"componentDidUpdate",value:function(e){e.cls===this.props.cls&&e.type===this.props.type&&e.subtype===this.props.subtype||this.updateCommSpec()}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,this.commSpec&&s.a.createElement("div",{style:{marginLeft:"15px"}},s.a.createElement("p",null,"CommSpec"),s.a.createElement("div",{style:{marginLeft:"15px"}},s.a.createElement("p",null,"read"),s.a.createElement("div",{style:{marginLeft:"15px"}},"starting-register",s.a.createElement("input",{style:{marginLeft:"10px"},id:"read-starting-register",onChange:this.readStartingVal,value:this.state.readStartingRegister||""}),this.state.readItems&&s.a.createElement("ul",{className:"list",onDragOver:this.dragOver},this.state.readItems.map((function(t,a){return s.a.createElement("li",{className:"m"===t.mo?"itemM":"o"===t.mo?"itemO":"itemX",key:L++,"data-id":a,draggable:"true",onDragStart:e.dragStart,onDragEnd:e.readDragEnd},t.item,"m"!==t.mo&&s.a.createElement(g.a,{style:{float:"right",margin:"-3px"},size:"sm",variant:"o"===t.mo?"danger":"success",onClick:function(){e.optionBtn("read",t)}},"o"===t.mo?"X":"O"))}))))),this.state.writeItems&&s.a.createElement("div",{style:{marginLeft:"15px"}},s.a.createElement("p",null,"write"),s.a.createElement("div",{style:{marginLeft:"15px"}},"starting-register",s.a.createElement("input",{style:{marginLeft:"10px"},id:"write-starting-register",onChange:this.writeStartingVal,value:this.state.writeStartingRegister||""}),s.a.createElement("ul",{className:"list",onDragOver:this.dragOver},this.state.writeItems.map((function(t,a){return s.a.createElement("li",{className:"m"===t.mo?"itemM":"o"===t.mo?"itemO":"itemX",key:L++,"data-id":a,draggable:"true",onDragStart:e.dragStart,onDragEnd:e.writeDragEnd},t.item,"m"!==t.mo&&s.a.createElement(g.a,{style:{float:"right",margin:"-3px"},size:"sm",variant:"o"===t.mo?"danger":"success",onClick:function(){e.optionBtn("write",t)}},"o"===t.mo?"X":"O"))})))))))}}]),a}(n.Component),j=a(27),N=a.n(j),P=a(63),V=a(64),U=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={files:null,selectFile:null,fileJson:null,addDeviceMessage:null,errorMsg:!0,class:null,canModify:!1,canLoad:!1},e.setClass=function(t){e.setState({class:t})},e.getFiles=function(){fetch("/devicespeclist",{headers:{"Content-Type":"application/json"},method:"GET"}).then((function(e){return e.json()})).then((function(t){"success"!==t.result?alert("\ud30c\uc77c \uac80\uc0c9 \uc2e4\ud328! "+t.errormsg):e.setState({files:t.files,selectFile:null,fileJson:null})}),(function(e){alert("\ud30c\uc77c \uac80\uc0c9 \uc2e4\ud328! "+e)}))},e.onListSelect=function(t){e.setState({selectFile:t}),fetch("/devicespec?file="+t,{headers:{"Content-Type":"application/json"},method:"GET"}).then((function(e){return e.json()})).then((function(t){"success"!==t.result?alert("\ud30c\uc77c \uac80\uc0c9 \uc2e4\ud328! "+t.errormsg):e.setState({fileJson:t.json})}),(function(e){window.alert("\ud30c\uc77c \uac80\uc0c9 \uc2e4\ud328! "+e)}))},e.onFilesUnload=function(){e.setState({files:null,selectFile:null,fileJson:null})},e.onAddDevice=function(){null!=e.state.selectFile&&null!=e.state.fileJson?e.props.onAddDevice(e.state.selectFile,e.state.fileJson):e.setState({addDeviceMessage:"\ucd94\uac00\ud560 \uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \uc120\ud0dd\ud558\uc138\uc694."})},e.onRemoveFile=function(){null!=e.state.selectFile?fetch("/devicespec?file="+e.state.selectFile,{headers:{"Content-Type":"application/json"},method:"DELETE"}).then((function(e){return e.json()})).then((function(t){"success"!==t.result?alert("\ud30c\uc77c \uc0ad\uc81c \uc2e4\ud328! "+t.errormsg):e.getFiles()}),(function(e){alert("\ud30c\uc77c \uc0ad\uc81c \uc2e4\ud328! "+e)})):e.setState({addDeviceMessage:"\uc0ad\uc81c\ud560 \uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \uc120\ud0dd\ud558\uc138\uc694."})},e.onModify=function(){null!=e.state.selectFile&&null!=e.state.fileJson?e.props.onModify(e.state.fileJson,e.state.selectFile):e.setState({addDeviceMessage:"\uc218\uc815\ud560 \uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \uc120\ud0dd\ud558\uc138\uc694."})},e.onLoad=function(){null!=e.state.selectFile&&null!=e.state.fileJson?e.props.onLoad(e.state.fileJson,e.state.selectFile):e.setState({addDeviceMessage:"\ubd88\ub7ec\uc62c \uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \uc120\ud0dd\ud558\uc138\uc694."})},e.onDownload=function(){if(!e.state.fileJson||e.state.fileJson.length<0)return e.setState({addDeviceMessage:"\ub2e4\uc6b4\ub85c\ub4dc\ud560 \uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \uc120\ud0dd\ud558\uc138\uc694."}),void console.log(e.state.errorMsg);var t=new Blob([JSON.stringify(e.state.fileJson,null,4)],{type:"text/plain;charset=utf-8"});Object(P.saveAs)(t,e.state.selectFile)},e.onUpload=function(){e.setState({errorMsg:!1},(function(){console.log(e.state.errorMsg),e.setState({errorMsg:!1,addDeviceMessage:"\uc5c5\ub85c\ub4dc \uc131\uacf5!"},(function(){console.log(e.state.errorMsg),e.getFiles(),e.setState({errorMsg:!0})}))}))},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getFiles(),this.setState({canModify:this.props.modify,canLoad:this.props.load})}},{key:"componentDidUpdate",value:function(e){e.show!==this.props.show&&this.props.show&&this.getFiles()}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,this.props.show&&s.a.createElement(N.a,{onUnload:this.onFilesUnload,center:"parent",title:"\uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c \ubd88\ub7ec\uc624\uae30",features:{width:800,height:800}},s.a.createElement("div",null,s.a.createElement(d.a,{fluid:!0,style:{margin:"10px"}},s.a.createElement(p.a,{style:{marginLeft:"10px",marginBottom:"10px"}},s.a.createElement(v.a,null),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px"},onClick:this.getFiles},"\uc0c8\ub85c\uace0\uce68"))),s.a.createElement(p.a,null,s.a.createElement(v.a,null,this.state.files&&this.state.files.length>0?s.a.createElement("div",{className:"heightPopup"},this.state.files.map((function(t,a){return s.a.createElement("div",{key:a},s.a.createElement(g.a,{key:a+"dvcspc",variant:e.state.selectFile===t?"primary":"outline-secondary",style:{minWidth:"300px",textAlign:"start",marginBottom:"1px"},onClick:function(){return e.onListSelect(t)}},t),s.a.createElement("br",null))}))):s.a.createElement("div",null,"\uc800\uc7a5\ub41c \ud30c\uc77c \uc5c6\uc74c")),s.a.createElement(v.a,{style:{borderLeft:"5px solid gray"}},s.a.createElement("pre",{className:"heightPopup"},s.a.createElement("code",null,this.state.fileJson&&JSON.stringify(this.state.fileJson,null,4))))),s.a.createElement(p.a,{style:{marginTop:"10px"}},s.a.createElement(v.a,null),s.a.createElement(v.a,{xs:"auto"},"node"===this.state.class&&s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"120px",marginRight:"10px"},onClick:this.onAddDevice},"Device\ub85c \ucd94\uac00"),this.state.canModify&&s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px",marginRight:"10px"},onClick:this.onModify},"\uc218\uc815"),this.state.canLoad&&s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px",marginRight:"10px"},onClick:this.onLoad},"\ubd88\ub7ec\uc624\uae30"),s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px",marginRight:"10px"},onClick:this.onDownload},"\ub2e4\uc6b4\ub85c\ub4dc"),s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px"},onClick:this.onRemoveFile},"\uc0ad\uc81c")))),this.state.addDeviceMessage&&s.a.createElement("div",{style:{position:"absolute",bottom:"40px",right:"10px",opacity:"0.95"}},s.a.createElement(f.a,{variant:!1===this.state.errorMsg?"success":"danger",onClose:function(){return e.setState({addDeviceMessage:null})},dismissible:!0},this.state.addDeviceMessage)),s.a.createElement("div",{style:{position:"absolute",bottom:"10px",left:"10px"}},s.a.createElement(V.FileUpload,{style:{height:"31px !important",backgroundColor:"#dddddd  !important"},mode:"basic",name:"file",url:"/devicespec",accept:".json",maxFileSize:1e6,onUpload:this.onUpload,auto:!0,chooseLabel:"\uc5c5\ub85c\ub4dc",multiple:!0})))))}}]),a}(n.Component),B=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={showFiles:!1,class:null,model:null,type:null,subtype:null,name:null,valueunit:null,valueunitetc:null,sd:null,channel:null,deviceSpecName:null,saveAlert:!1,saveResult:!0,saveErrorMessage:null,overwrite:!1,overwriteMessage:!1,addDeviceList:{},refresh:null},n.setModel=function(){n.setState({model:document.getElementById("modelInput").value})},n.setName=function(){n.setState({name:document.getElementById("nameInput").value})},n.setChannel=function(){n.setState({channel:document.getElementById("channelInput").value})},n.setValueUnitEtc=function(){n.setState({valueunitetc:document.getElementById("valueUnitInput").value})},n.setDeviceSpecName=function(){n.setState({deviceSpecName:document.getElementById("deviceSpecNameInput").value})},n.setSaveMsg=function(e,t){n.setState({saveResult:e,saveErrorMessage:t,saveAlert:!0})},n.overwriteClick=function(){n.setState({overwrite:!0,overwriteMessage:!1,saveAlert:!1},(function(){n.saveClick(),n.setState({overwrite:!1})}))},n.onShowFiles=function(){n.setState({showFiles:!1},(function(){n.setState({showFiles:!0})}))},n.onModify=function(e,t){n.setJson(e),document.getElementById("deviceSpecNameInput").value=t,n.setDeviceSpecName()},n.onCommSpecChange=function(){n.setState({refresh:null})},n.setJson=function(e){if(e.Class&&n.setState({class:e.Class},(function(){n.csCmpRef.current.setCommSpec(e.CommSpec),n.dvcPopRef.current.setClass(n.state.class)})),e.Type)if(e.Type.indexOf("/")>0){var t=e.Type.split("/");n.setState({type:t[0],subtype:t[1]})}else n.setState({type:e.Type,subtype:null});if(e.Model&&"null"!==e.Model&&(n.setState({model:e.Model}),document.getElementById("modelInput").value=e.Model),e.Name&&"null"!==e.Name&&(n.setState({name:e.Name}),document.getElementById("nameInput").value=e.Name),e.ValueUnit&&("string"===e.ValueType?n.setState({valueunitetc:e.ValueUnit,valueunit:"etc"},(function(){document.getElementById("valueUnitInput").value=e.ValueUnit})):n.setState({valueunitetc:null,valueunit:e.ValueUnit})),void 0!==e.SignificantDigit&&null!==e.SignificantDigit&&(console.log(e.SignificantDigit),n.setState({sd:e.SignificantDigit})),e.Channel&&n.setState({channel:e.Channel},(function(){document.getElementById("channelInput").value=e.Channel})),e.Devices&&e.Devices.length>0){var a={};e.Devices.map((function(e,t){a["tmp"+t]=e})),n.setState({addDeviceList:a})}},n.onAddDevice=function(e,t){n.state.addDeviceList[e]=t,n.setState({addDeviceList:n.state.addDeviceList})},n.onRemoveFromDeviceList=function(e){delete n.state.addDeviceList[e],n.setState({addDeviceList:n.state.addDeviceList})},n.saveClick=function(){n.state.deviceSpecName?fetch("/devicespec",{body:JSON.stringify({name:n.state.deviceSpecName,overwrite:n.state.overwrite,json:n.getJson()}),headers:{"Content-Type":"application/json"},method:"PUT"}).then((function(e){return e.json()})).then((function(e){"error"===e.result?n.setSaveMsg(!1,e.errormsg):"duplicate"===e.result?(n.state.overwriteMessage=!0,n.setSaveMsg(!1,null)):"success"===e.result?n.setSaveMsg(!0,e.file):n.setSaveMsg(!1,e.errormsg)}),(function(e){n.setSaveMsg(!1,e)})):n.setSaveMsg(!1,"\uc7a5\ube44 \uaddc\uaca9 \uc774\ub984\uc744 \uc785\ub825\ud558\uc138\uc694.")},n.isSensor=function(){return"sensor"===n.state.class},n.getJson=function(){var e={};if(e.Class=n.state.class,e.Type=n.state.type,null!=n.state.subtype&&(e.Type+="/"+n.state.subtype),null!=n.state.model&&n.state.model.length>0&&(e.Model=n.state.model),null!=n.state.name&&n.state.name.length>0&&(e.Name=n.state.name),n.isSensor()&&("etc"===n.state.valueunit?(e.ValueUnit=n.state.valueunitetc,e.ValueType="string"):(e.ValueUnit=parseInt(n.state.valueunit),e.ValueType="float"),"None"!==n.state.sd&&null!==n.state.sd&&(e.SignificantDigit=parseInt(n.state.sd))),null!=n.state.class){if("node"!==n.state.class&&null!==n.state.channel&&n.state.channel.length>0){var t=parseInt(n.state.channel);isNaN(t)||(e.Channel=t)}if(n.csCmpRef&&n.csCmpRef.current){var a=n.csCmpRef.current.getCommSpec();a&&(e.CommSpec=a)}if("node"===n.state.class&&Object.keys(n.state.addDeviceList).length>0){var s=[];Object.keys(n.state.addDeviceList).map((function(e){return s.push(n.state.addDeviceList[e]),null})),e.Devices=s}}return e},n.csCmpRef=s.a.createRef(),n.dvcPopRef=s.a.createRef(),n}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=0;return s.a.createElement(s.a.Fragment,null,s.a.createElement(U,{ref:this.dvcPopRef,show:this.state.showFiles,modify:!0,onModify:this.onModify,onAddDevice:this.onAddDevice}),s.a.createElement(d.a,{fluid:!0,style:{margin:"10px"}},s.a.createElement(p.a,{style:{marginBottom:"20px",marginLeft:"10px"}},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"200px"},onClick:this.onShowFiles},"\uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c \uac80\uc0c9")),s.a.createElement(p.a,null,s.a.createElement(v.a,null,s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(v.a,{style:{width:"120px"},xs:"auto"},"Class"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(h.a,{onSelect:function(t,a){e.state.class!==t&&e.setState({type:null,subtype:null,valueunit:null,addDeviceList:{},commSpec:null},(function(){e.csCmpRef.current.setCommSpec(null),e.dvcPopRef.current.setClass(e.state.class)})),e.setState({class:t})}},s.a.createElement(h.a.Toggle,{variant:"secondary",id:"dropdown-basic"},null==this.state.class?"Class":this.state.class),s.a.createElement(h.a.Menu,null,w.map((function(e){return s.a.createElement(h.a.Item,{key:t++,eventKey:e},e)})))))),s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(v.a,{xs:"auto",style:{width:"120px"}},"Type"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(h.a,{onSelect:function(t,a){e.csCmpRef.current.setCommSpec(null),e.setState({type:t})}},s.a.createElement(h.a.Toggle,{variant:"secondary",id:"dropdown-basic"},null==this.state.type?"Type":this.state.type),s.a.createElement(h.a.Menu,null,function(e){if(null==e)return[];var t=e.replace("-","_"),a=C[t];return void 0===a?[]:a}(this.state.class).map((function(e){return s.a.createElement(h.a.Item,{key:t++,eventKey:e},e)}))))),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(h.a,{onSelect:function(t,a){e.csCmpRef.current.setCommSpec(null),e.setState({subtype:t})}},s.a.createElement(h.a.Toggle,{variant:"secondary",id:"dropdown-basic"},null==this.state.subtype?"SubType":this.state.subtype),s.a.createElement(h.a.Menu,null,function(e){if(null==e)return[];var t=e.replace("-","_"),a=x[t];return void 0===a?[]:a}(this.state.type).map((function(e){return s.a.createElement(h.a.Item,{key:t++,eventKey:e},e)})))))),s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(v.a,{xs:"auto",style:{width:"120px"}},"Model"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement("input",{id:"modelInput",onKeyUp:this.setModel}))),s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(v.a,{xs:"auto",style:{width:"120px"}},"Name"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement("input",{id:"nameInput",onKeyUp:this.setName}))),this.isSensor()&&s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(v.a,{style:{width:"120px"},xs:"auto"},"ValueUnit"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(h.a,{onSelect:function(t,a){"etc"===t&&"etc"!==e.state.valueunit&&e.setState({valueunitetc:null}),e.setState({valueunit:t})}},s.a.createElement(h.a.Toggle,{variant:"secondary",id:"dropdown-basic"},null==this.state.valueunit?"ValueUnit":this.state.valueunit),s.a.createElement(h.a.Menu,null,O.map((function(e){return s.a.createElement(h.a.Item,{key:t++,eventKey:e},e)}))))),"etc"===this.state.valueunit&&s.a.createElement(v.a,{xs:"auto"},s.a.createElement("input",{id:"valueUnitInput",onKeyUp:this.setValueUnitEtc}))),this.isSensor()&&s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(v.a,{style:{width:"120px"},xs:"auto"},"SignificantDigit"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(h.a,{onSelect:function(t,a){e.setState({sd:t})}},s.a.createElement(h.a.Toggle,{variant:"secondary",id:"dropdown-basic"},null==this.state.sd?"SD":this.state.sd),s.a.createElement(h.a.Menu,null,b.map((function(e){return s.a.createElement(h.a.Item,{key:t++,eventKey:e},e)})))))),"node"!==this.state.class&&s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(v.a,{xs:"auto",style:{width:"120px"}},"Channel"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement("input",{id:"channelInput",onKeyUp:this.setChannel}))),s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(F,{ref:this.csCmpRef,cls:this.state.class,type:this.state.type,subtype:this.state.subtype,onChanged:this.onCommSpecChange})),"node"===this.state.class&&s.a.createElement(p.a,{style:{marginBottom:"10px"}},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"200px"},onClick:this.onShowFiles},"Device \ucd94\uac00")),"node"===this.state.class&&Object.keys(this.state.addDeviceList).length>0&&s.a.createElement("div",{className:"heightDevice"},Object.keys(this.state.addDeviceList).map((function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("div",{style:{width:"300px",height:"33px",border:"1px solid gray",background:"#e2e2e2",borderRadius:"4px",paddingLeft:"5px",marginBottom:"-20px"}},s.a.createElement("p",{style:{width:"200px",display:"inline",verticalAlign:"middle"}},t),s.a.createElement(g.a,{style:{float:"right"},size:"sm",variant:"danger",onClick:function(){return e.onRemoveFromDeviceList(t)}},"X")),s.a.createElement("br",null))})))),s.a.createElement(v.a,{style:{borderLeft:"5px solid gray"}},s.a.createElement("pre",{className:"heightLine"},s.a.createElement("code",null,JSON.stringify(this.getJson(),null,4))))),s.a.createElement(p.a,{style:{marginTop:"10px"}},s.a.createElement(v.a,{xs:"auto",style:{width:"130px"}},"\uc7a5\ube44 \uaddc\uaca9 \uc774\ub984"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement("input",{style:{width:"400px"},id:"deviceSpecNameInput",onKeyUp:this.setDeviceSpecName})),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px"},onClick:this.saveClick},"\uc800\uc7a5")))),this.state.saveAlert&&s.a.createElement("div",{style:{position:"absolute",bottom:"70px",left:"10px",opacity:"0.95"}},s.a.createElement(f.a,{variant:this.state.saveResult?"success":"danger",onClose:function(){return e.setState({saveAlert:!1})},dismissible:!0},s.a.createElement(f.a.Heading,null,this.state.saveResult?"\ud30c\uc77c \uc800\uc7a5 \uc131\uacf5!":"\ud30c\uc77c \uc800\uc7a5 \uc2e4\ud328!"),this.state.saveErrorMessage&&s.a.createElement("p",null,this.state.saveErrorMessage),this.state.overwriteMessage&&s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,"\ub3d9\uc77c\ud55c \uc774\ub984\uc758 \uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc774 \uc788\uc2b5\ub2c8\ub2e4. \ub36e\uc5b4\uc4f0\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"),s.a.createElement("hr",null),s.a.createElement("div",{className:"d-flex justify-content-end"},s.a.createElement(g.a,{style:{marginRight:"10px"},onClick:this.overwriteClick,variant:"outline-success"},"\uc608"),s.a.createElement(g.a,{onClick:function(){e.setState({saveAlert:!1,overwriteMessage:!1})},variant:"outline-danger"},"\uc544\ub2c8\uc694"))))))}}]),a}(n.Component),J=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={command:"SET",device:null,deviceList:[],operations:{},targets:{},operation:null,devicespec:null},n.setDeviceSpec=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){if(Object.equals(e,n.state.devicespec))return void console.log("same");n.state.devicespec=e;var a=[],s={},r={};if(e.Class){if(a.push(e.Class),e.CommSpec){var i=null;(i=t?M(e):D(e.CommSpec))&&(r[e.Class]=i.read)}var l=null;(l=t?R(e.Class,e.Type):k(e.Class,e.Type))&&(s[e.Class]=l)}if(e.Devices){var o=0;e.Devices.map((function(e){var n=o+++":"+e.Class;if(e.Name&&(n+=":"+e.Name),a.push(n),e.CommSpec){var i=null;(i=t?M(e):D(e.CommSpec))&&(r[n]=i.read)}var l=null;(l=t?R(e.Class,e.Type):k(e.Class,e.Type))&&(s[n]=l)}))}n.setState({deviceList:a,operations:s,targets:r})}},n.getParameter=function(){if("SET"!==n.state.command)return s.a.createElement(s.a.Fragment,null);var e=n.state.operations[n.state.device];if(e)for(var t=0;t<e.length;t++){var a=e[t];if(a.Operation===n.state.operation){if(a.Parameters)return s.a.createElement("div",{style:{border:"1px solid gray",padding:"10px",margin:"10px"}},"Parameter",s.a.createElement(p.a,null,a.Parameters.map((function(e,t){return s.a.createElement(v.a,{key:t,xs:"auto"},s.a.createElement(v.a,{xs:"auto"},e.Parameter),s.a.createElement(v.a,{xs:"auto"},s.a.createElement("input",{id:"param"+t})))}))));break}}return s.a.createElement(s.a.Fragment,null)},n.getTarget=function(){if("GET"!==n.state.command)return s.a.createElement(s.a.Fragment,null);var e=n.state.targets[n.state.device];return e?s.a.createElement("div",{style:{border:"1px solid gray",padding:"10px",margin:"10px"}},"Target",s.a.createElement(p.a,null,e.map((function(e,t){return s.a.createElement(v.a,{key:t,xs:"auto"},s.a.createElement(v.a,{xs:"auto"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",id:"target"+t}),e)))})))):s.a.createElement(s.a.Fragment,null)},n.getExpect=function(){if("EXPECT"!==n.state.command)return s.a.createElement(s.a.Fragment,null);var e=n.state.targets[n.state.device];return e?s.a.createElement("div",{style:{border:"1px solid gray",padding:"10px",margin:"10px"}},"Target",s.a.createElement(p.a,null,e.map((function(e,t){return s.a.createElement(v.a,{key:t,xs:"auto"},s.a.createElement(v.a,{xs:"auto"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",id:"expectchk"+t}),e),s.a.createElement("input",{style:{width:"40px"},id:"expect"+t})))})))):s.a.createElement(s.a.Fragment,null)},n.onCreate=function(){var e=n.divRef.current.ownerDocument;if(!n.state.deviceList||n.state.deviceList.length<=0)alert("\uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \ubd88\ub7ec\uc640\uc57c \ud569\ub2c8\ub2e4.");else{var t={};if(t.command=n.state.command,"SET"===n.state.command){if(!n.state.device)return void alert("DEVICE\ub97c \uc120\ud0dd\ud574\uc57c \ud569\ub2c8\ub2e4.");if(!n.state.operation)return void alert("OPERATION\uc744 \uc120\ud0dd\ud574\uc57c \ud569\ub2c8\ub2e4.");var a=n.state.device;t.device=a,t.operation=n.state.operation;var s=n.state.operations[n.state.device];if(s)for(var r=0;r<s.length;r++){var i=s[r];if(i.Operation===n.state.operation&&i.Parameters){t.parameters=[];for(var l=0;l<i.Parameters.length;l++){var o=i.Parameters[l],c={};if(c=Object.assign(c,o),!(c=Object.assign(c,{value:e.getElementById("param"+l).value})).value&&"m"===c.MO)return void alert("Parameter "+c.Parameter+"\ub97c \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4.");t.parameters.push(c)}}}}else if("GET"===n.state.command){if(!n.state.device)return void alert("DEVICE\ub97c \uc120\ud0dd\ud574\uc57c \ud569\ub2c8\ub2e4.");if(t.device=n.state.device,d=n.state.targets[n.state.device]){var u="";for(r=0;r<d.length;r++){var m=d[r];e.getElementById("target"+r).checked&&(u.length>0&&(u+=","),u+=m)}if(u.length<=0)return void alert("\ud558\ub098 \uc774\uc0c1\uc758 Target\uc744 \uc120\ud0dd\ud574\uc57c \ud569\ub2c8\ub2e4.");t.targets=u}}else if("EXPECT"===n.state.command){if(!n.state.device)return void alert("DEVICE\ub97c \uc120\ud0dd\ud574\uc57c \ud569\ub2c8\ub2e4.");var d;if(t.device=n.state.device,d=n.state.targets[n.state.device]){for(u="",r=0;r<d.length;r++){m=d[r];if(e.getElementById("expectchk"+r).checked){if(!(p=e.getElementById("expect"+r).value))return void alert("\uc120\ud0dd\ud55c Target\uc758 \uac12\uc744 \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4.");u.length>0&&(u+=","),u+=m+":"+p}}if(u.length<=0)return void alert("\ud558\ub098 \uc774\uc0c1\uc758 Target\uc744 \uc120\ud0dd\ud574\uc57c \ud569\ub2c8\ub2e4.");t.targets=u}}else if("SLEEP"===n.state.command){var p;if(!(p=e.getElementById("timeval").value))return void alert("\uc2dc\uac04\uac12\uc744 \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4.");t.time=p}n.props.onCreate(t)}},n.divRef=s.a.createRef(),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.props.deviceSpec&&this.setDeviceSpec(this.props.deviceSpec,!0)}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{style:{height:"180px"},ref:this.divRef},s.a.createElement(d.a,{fluid:!0,style:{margin:"10px"}},s.a.createElement(p.a,{style:{marginLeft:"0px",marginBottom:"10px"}},s.a.createElement(v.a,{xs:"auto"},s.a.createElement(h.a,{onSelect:function(t,a){e.setState({command:t})}},s.a.createElement(h.a.Toggle,{variant:"secondary",id:"dropdown-basic"},this.state.command),s.a.createElement(h.a.Menu,null,s.a.createElement(h.a.Item,{eventKey:"SET"},"SET"),s.a.createElement(h.a.Item,{eventKey:"GET"},"GET"),s.a.createElement(h.a.Item,{eventKey:"EXPECT"},"EXPECT"),s.a.createElement(h.a.Item,{eventKey:"SLEEP"},"SLEEP")))),"SLEEP"!==this.state.command&&s.a.createElement(v.a,{xs:"auto"},s.a.createElement(h.a,{onSelect:function(t,a){e.setState({device:t,operation:null})}},s.a.createElement(h.a.Toggle,{variant:"secondary",id:"dropdown-basic"},this.state.device?this.state.device:"DEVICE"),s.a.createElement(h.a.Menu,null,this.state.deviceList.map((function(e,t){return s.a.createElement(h.a.Item,{key:t,eventKey:e},e)}))))),"SET"===this.state.command&&s.a.createElement(v.a,{xs:"auto"},s.a.createElement(h.a,{onSelect:function(t,a){e.setState({operation:t})}},s.a.createElement(h.a.Toggle,{variant:"secondary",id:"dropdown-basic"},this.state.operation?this.state.operation:"OPERATION"),this.state.operations[this.state.device]&&s.a.createElement(h.a.Menu,null,this.state.operations[this.state.device].map((function(e,t){return s.a.createElement(h.a.Item,{key:t,eventKey:e.Operation},e.Operation)}))))),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",style:{width:"80px"},onClick:this.onCreate},"\ucd94\uac00"))),s.a.createElement(p.a,null,this.getParameter()),s.a.createElement(p.a,null,this.getTarget()),s.a.createElement(p.a,null,this.getExpect()),"SLEEP"===this.state.command&&s.a.createElement(p.a,null,s.a.createElement(v.a,{xs:"auto"},s.a.createElement(v.a,{xs:"auto"},"Time(ms)"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement("input",{id:"timeval"}))))))}}]),a}(n.Component),A=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={deviceSpec:null},n.setDeviceSpec=function(e){n.setState({deviceSpec:e})},n.onCreate=function(e){n.props.onCreate(e)},n.onUnload=function(){n.setState({command:"SET",device:null,deviceList:[],operations:{},targets:{},operation:null})},n.testRef=s.a.createRef(),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,this.props.show&&s.a.createElement(N.a,{onUnload:this.onUnload,center:"parent",title:"\uc608\uc678\uc694\uccad \ucd94\uac00",features:{width:800,height:250}},s.a.createElement("div",null,s.a.createElement(J,{ref:this.testRef,onCreate:this.onCreate,deviceSpec:this.state.deviceSpec}))))}}]),a}(n.Component),z=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={files:null,selectFile:null,fileData:null,addDeviceMessage:null},e.getFiles=function(){fetch("/testspeclist",{headers:{"Content-Type":"application/json"},method:"GET"}).then((function(e){return e.json()})).then((function(t){"success"!==t.result?alert("\ud30c\uc77c \uac80\uc0c9 \uc2e4\ud328! "+t.errormsg):e.setState({files:t.files,selectFile:null,fileData:null})}),(function(e){alert("\ud30c\uc77c \uac80\uc0c9 \uc2e4\ud328! "+e)}))},e.onListSelect=function(t){e.setState({selectFile:t}),fetch("/testspec?file="+t,{headers:{"Content-Type":"application/json"},method:"GET"}).then((function(e){return e.json()})).then((function(t){"success"!==t.result?alert("\ud30c\uc77c \uac80\uc0c9 \uc2e4\ud328! "+t.errormsg):e.setState({fileData:t.data})}),(function(e){alert("\ud30c\uc77c \uac80\uc0c9 \uc2e4\ud328! "+e)}))},e.onLoad=function(){null!=e.state.selectFile&&null!=e.state.fileData?e.props.onLoad(e.state.fileData,e.state.selectFile):e.setState({addDeviceMessage:"\ubd88\ub7ec\uc62c \uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \uc120\ud0dd\ud558\uc138\uc694."})},e.onFilesUnload=function(){e.setState({files:null,selectFile:null,fileData:null})},e.onRemoveFile=function(){null!=e.state.selectFile?fetch("/testspec?file="+e.state.selectFile,{headers:{"Content-Type":"application/json"},method:"DELETE"}).then((function(e){return e.json()})).then((function(t){"success"!==t.result?alert("\ud30c\uc77c \uc0ad\uc81c \uc2e4\ud328! "+t.errormsg):e.getFiles()}),(function(e){alert("\ud30c\uc77c \uc0ad\uc81c \uc2e4\ud328! "+e)})):e.setState({addDeviceMessage:"\uc0ad\uc81c\ud560 \uc2dc\ud5d8\ud30c\uc77c\uc744 \uc120\ud0dd\ud558\uc138\uc694."})},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getFiles()}},{key:"componentDidUpdate",value:function(e){e.show!==this.props.show&&this.props.show&&this.getFiles()}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,this.props.show&&s.a.createElement(N.a,{onUnload:this.onFilesUnload,center:"parent",title:"\uc2dc\ud5d8\ud30c\uc77c \ubd88\ub7ec\uc624\uae30",features:{width:1e3,height:800}},s.a.createElement("div",null,s.a.createElement(d.a,{fluid:!0,style:{margin:"10px"}},s.a.createElement(p.a,{style:{marginLeft:"10px",marginBottom:"10px"}},s.a.createElement(v.a,null),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px"},onClick:this.getFiles},"\uc0c8\ub85c\uace0\uce68"))),s.a.createElement(p.a,null,s.a.createElement(v.a,null,this.state.files&&this.state.files.length>0?s.a.createElement("div",{className:"heightPopup"},this.state.files.map((function(t,a){return s.a.createElement("div",{key:a},s.a.createElement(g.a,{key:a+"dvcspc",variant:e.state.selectFile===t?"primary":"outline-secondary",style:{minWidth:"200px",textAlign:"start",marginBottom:"1px"},onClick:function(){return e.onListSelect(t)}},t),s.a.createElement("br",null))}))):s.a.createElement("div",null,"\uc800\uc7a5\ub41c \ud30c\uc77c \uc5c6\uc74c")),s.a.createElement(v.a,{style:{borderLeft:"5px solid gray"}},s.a.createElement("pre",{className:"heightPopup"},s.a.createElement("code",null,this.state.fileData&&this.state.fileData)))),s.a.createElement(p.a,{style:{marginTop:"10px"}},s.a.createElement(v.a,null),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px",marginRight:"10px"},onClick:this.onLoad},"\ubd88\ub7ec\uc624\uae30"),s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px"},onClick:this.onRemoveFile},"\uc0ad\uc81c")))),this.state.addDeviceMessage&&s.a.createElement("div",{style:{position:"absolute",bottom:"40px",right:"10px",opacity:"0.95"}},s.a.createElement(f.a,{variant:"danger",onClose:function(){return e.setState({addDeviceMessage:null})},dismissible:!0},this.state.addDeviceMessage)))))}}]),a}(n.Component),K=(a(97),a(47)),X=a(72),q=a(73),G=a(74),_=(a(103),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={deviceList:[],selectDevice:null,slaveList:[],selectSlave:null,invalidDevice:!1,imageURL:null,imageURLDetail:null,isLoading:!1,errorMsg:null,detail:!1},e.deviceSpec=null,e.testSpec=null,e.setSpec=function(t,a){console.log(t),console.log(a),e.deviceSpec=t,e.testSpec=a,e.getSerialport()},e.getSerialport=function(){fetch("/serialport",{headers:{"Content-Type":"application/json"},method:"GET"}).then((function(e){return e.json()})).then((function(t){"success"!==t.result?alert("\uc7a5\ube44 \uac80\uc0c9 \uc2e4\ud328! "+t.errormsg):e.setState({deviceList:t.ports},(function(){e.state.deviceList.length>0&&e.setState({selectDevice:e.state.deviceList[0]})}))}),(function(e){alert("\uc7a5\ube44 \uac80\uc0c9 \uc2e4\ud328! "+e)}))},e.onChangeDevice=function(t){e.setState({selectDevice:t.value,invalidDevice:!1})},e.onChangeSlave=function(t){e.setState({selectSlave:t.value})},e.onUnload=function(){e.props.unload(),e.setState({selectDevice:null,invalidDevice:!1,imageURL:null,isLoading:!1,errorMsg:null})},e.startTest=function(){null!=e.state.selectDevice?(e.setState({isLoading:!0,imageURL:null,errorMsg:null}),fetch("/serialport",{headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e.state.selectDevice,device:e.deviceSpec,test:e.testSpec,slave:e.state.selectSlave}),method:"POST"}).then((function(e){return e.json()})).then((function(t){e.setState({isLoading:!1}),"success"!==t.result?(console.log(t),e.setState({errorMsg:t.errormsg})):e.setState({imageURL:t.url,imageURLDetail:t.urldetail})}),(function(t){e.setState({isLoading:!1,errorMsg:t})}))):e.setState({invalidDevice:!0})},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){for(var e=[],t=1;t<=247;t++)e.push(t);this.setState({slaveList:e,selectSlave:1})}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,this.props.show&&s.a.createElement(N.a,{onUnload:this.onUnload,center:"parent",title:"\uc7a5\ube44 \uc2dc\ud5d8",features:{width:800,height:800},style:{fontSize:"12px"}},s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"p-grid",style:{margin:"20px 10px 10px 10px",fontSize:"12px"}},s.a.createElement("div",{className:"p-col"},s.a.createElement("div",{className:"p-field p-fluid"},s.a.createElement("span",{className:"p-float-label"},s.a.createElement(K.Dropdown,{className:this.state.invalidDevice?"p-invalid p-mr-2":null,value:this.state.selectDevice,options:this.state.deviceList,onChange:this.onChangeDevice}),s.a.createElement("label",{htmlFor:"dropdown"},"\uc7a5\ube44 \uc120\ud0dd")),this.state.invalidDevice&&s.a.createElement("small",{id:"username-help",className:"p-invalid"},"\uc7a5\ube44\ub97c \uc120\ud0dd\ud574\uc57c \ud569\ub2c8\ub2e4."))),s.a.createElement("div",{className:"p-col"},s.a.createElement("span",{className:"p-float-label"},s.a.createElement(K.Dropdown,{value:this.state.selectSlave,options:this.state.slaveList,onChange:this.onChangeSlave}),s.a.createElement("label",{htmlFor:"dropdown"},"Slave"))),s.a.createElement("div",{className:"p-col"},s.a.createElement(X.Button,{className:"p-button-secondary",label:"\uc2dc\ud5d8 \uc2dc\uc791",onClick:this.startTest}))),s.a.createElement("div",{className:"p-grid",style:{margin:"0px 10px 10px 20px"}},s.a.createElement("h6",{style:{marginRight:"10px"}},"\uc0c1\uc138\ubcf4\uae30"),s.a.createElement(G.InputSwitch,{checked:this.state.detail,onChange:function(t){return e.setState({detail:t.value})}})),s.a.createElement("div",{className:"p-grid p-justify-center result-area"},s.a.createElement("div",{className:"p-col-align-center"},this.state.isLoading&&s.a.createElement(q.ProgressSpinner,null),this.state.detail&&this.state.imageURLDetail&&s.a.createElement("img",{alt:"\uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328!",src:this.state.imageURLDetail}),!this.state.detail&&this.state.imageURL&&s.a.createElement("img",{alt:"\uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328!",src:this.state.imageURL}),this.state.errorMsg&&s.a.createElement("h3",null,"\uc2dc\ud5d8 \uc2e4\ud328!",s.a.createElement("br",null),this.state.errorMsg))))))}}]),a}(n.Component)),H=a(75),W=a(48),$=a(76),Q=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={showFiles:!1,showTestFiles:!1,loadJson:null,loadFile:null,showCreate:!1,showTest:!1,tests:[],saveAlert:!1,saveResult:!1,overwrite:!1,saveErrorMessage:null,overwriteMessage:null,rowSelected:null},n.onShowFiles=function(){n.setState({showFiles:!1},(function(){n.setState({showFiles:!0})}))},n.onShowTestFiles=function(){n.setState({showTestFiles:!1},(function(){n.setState({showTestFiles:!0})}))},n.onLoad=function(e,t){n.setState({loadJson:e,loadFile:t,showFiles:!1}),n.testRef.current.setDeviceSpec(e)},n.onTestLoad=function(e,t){var a=e.split("\n"),s=[];a.map((function(e,t){e.trim().length>0&&s.push({id:t,test:e})})),document.getElementById("testSpecNameInput").value=t,n.setState({tests:s,showTestFiles:!1})},n.onCreateTest=function(){null!==n.state.loadFile?n.setState({showCreate:!1},(function(){n.testPopRef.current.setDeviceSpec(n.state.loadJson,!0),n.setState({showCreate:!0})})):alert("\uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \ubd88\ub7ec\uc640\uc57c \ud569\ub2c8\ub2e4.")},n.setSaveMsg=function(e,t){n.setState({saveResult:e,saveErrorMessage:t,saveAlert:!0})},n.overwriteClick=function(){n.setState({overwrite:!0,overwriteMessage:!1,saveAlert:!1},(function(){n.saveClick(),n.setState({overwrite:!1})}))},n.getTestSpec=function(){return n.state.tests},n.saveClick=function(){var e=document.getElementById("testSpecNameInput").value;if(e){var t=n.getTestSpec();!t||t.length<=0?n.setSaveMsg(!1,"\uc800\uc7a5\ud560 \uc2dc\ud5d8\ud30c\uc77c \ub0b4\uc6a9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."):fetch("/testspec",{body:JSON.stringify({name:e,overwrite:n.state.overwrite,data:t}),headers:{"Content-Type":"application/json"},method:"PUT"}).then((function(e){return e.json()})).then((function(e){"error"===e.result?n.setSaveMsg(!1,e.errormsg):"duplicate"===e.result?(n.state.overwriteMessage=!0,n.setSaveMsg(!1,null)):"success"===e.result?n.setSaveMsg(!0,e.file):n.setSaveMsg(!1,e.errormsg)}),(function(e){n.setSaveMsg(!1,e)}))}else n.setSaveMsg(!1,"\uc2dc\ud5d8\ud30c\uc77c \uc774\ub984\uc744 \uc785\ub825\ud558\uc138\uc694.")},n.onCreate=function(e){if(e){var t=e.command+" ";if("SET"===e.command){if(t+="DEVICE="+e.device+" ",t+="OPERATION="+e.operation,e.parameters&&e.parameters.length>0){for(var a="",s=0;s<e.parameters.length;s++){var r=e.parameters[s];r.value&&(a.length>0&&(a+=","),a+=r.Parameter,a+=":"+r.value)}a.length>0&&(t+=" PARAMETER="+a)}}else"GET"===e.command||"EXPECT"===e.command?(t+="DEVICE="+e.device+" ",e.targets&&(t+="TARGET="+e.targets)):"SLEEP"===e.command&&(t+="TIME="+e.time);n.state.tests.push({id:n.state.tests.length,test:t}),n.setState({tests:n.state.tests})}},n.testClick=function(){if(null!==n.state.loadFile){var e=n.getTestSpec();!e||e.length<=0?alert("\uc2dc\ud5d8\ud560 \ub0b4\uc6a9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."):n.setState({showTest:!0},(function(){n.excuteTestRef.current.setSpec(n.state.loadJson,e)}))}else alert("\uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc744 \ubd88\ub7ec\uc640\uc57c \ud569\ub2c8\ub2e4.")},n.testUnload=function(){n.setState({showTest:!1})},n.onRowReorder=function(e){if(null==n.state.rowSelected)n.setState({tests:e.value});else{var t=[],a=[];n.state.rowSelected.map((function(e){a.push(e.id)})),n.state.tests.map((function(e){a.indexOf(e.id)>=0&&(t.push({id:e.id,test:String(e.test)}),e.test="!@!@!")}));for(var s=t.length-1;s>=0;s--)n.state.tests.splice(e.dropIndex,0,t[s]);for(var r=n.state.tests.length-1;r>=0;r--)"!@!@!"===n.state.tests[r].test&&n.state.tests.splice(r,1);n.setState({tests:n.state.tests,rowSelected:null})}},n.onSelectCopy=function(){if(!(null==n.state.rowSelected||n.state.rowSelected.length<=0)){var e=[],t=[];n.state.rowSelected.map((function(t){e.push(t.id)}));var a=n.state.tests.length;n.state.tests.map((function(n){e.indexOf(n.id)>=0&&t.push({id:a++,test:String(n.test)})})),t.map((function(e){n.state.tests.push(e)})),n.setState({tests:n.state.tests})}},n.onSelectDelete=function(){if(!(null==n.state.rowSelected||n.state.rowSelected.length<=0)){n.state.rowSelected.map((function(e){for(var t=n.state.tests.length-1;t>=0;t--)if(n.state.tests[t].id==e.id){n.state.tests.splice(t,1);break}})),n.setState({tests:n.state.tests})}},n.testEditor=function(e){return s.a.createElement($.InputText,{style:{width:"100%"},type:"text",value:e.rowData.test,onChange:function(t){return n.onEditorValueChange(e,t.target.value)}})},n.onEditorValueChange=function(e,t){n.state.tests[e.rowIndex].test=t,n.setState({tests:n.state.tests})},n.dvcPopRef=s.a.createRef(),n.testRef=s.a.createRef(),n.testListRef=s.a.createRef(),n.testPopRef=s.a.createRef(),n.excuteTestRef=s.a.createRef(),n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement(_,{ref:this.excuteTestRef,show:this.state.showTest,unload:this.testUnload}),s.a.createElement(U,{ref:this.dvcPopRef,show:this.state.showFiles,load:!0,onLoad:this.onLoad}),s.a.createElement(z,{ref:this.testListRef,show:this.state.showTestFiles,onLoad:this.onTestLoad}),s.a.createElement(A,{ref:this.testPopRef,show:this.state.showCreate,onCreate:this.onCreate}),s.a.createElement(d.a,{fluid:!0,style:{margin:"10px"}},s.a.createElement(p.a,{style:{margin:"10px"}},s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"200px"},onClick:this.onShowFiles},"\uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c \ubd88\ub7ec\uc624\uae30")),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"200px"},onClick:this.onShowTestFiles},"\uc2dc\ud5d8 \ud30c\uc77c \ubd88\ub7ec\uc624\uae30")),s.a.createElement(v.a,null,this.state.loadFile)),s.a.createElement(p.a,null,s.a.createElement(J,{ref:this.testRef,onCreate:this.onCreate})),s.a.createElement(p.a,{style:{margin:"10px"}},s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"200px"},onClick:this.onCreateTest},"\uc608\uc678\uc694\uccad \uc0dd\uc131")),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"200px"},onClick:this.onSelectCopy},"\uc120\ud0dd\ud56d\ubaa9 \ubcf5\uc0ac")),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"200px"},onClick:this.onSelectDelete},"\uc120\ud0dd\ud56d\ubaa9 \uc0ad\uc81c"))),s.a.createElement(p.a,null,s.a.createElement("div",{className:"grid"},s.a.createElement(H.DataTable,{value:this.state.tests,editMode:"cell",className:"p-datatable-sm editable-cells-table",onRowReorder:this.onRowReorder,selectionMode:"multiple",dataKey:"id",selection:this.state.rowSelected,onSelectionChange:function(t){return e.setState({rowSelected:t.value})}},s.a.createElement(W.Column,{rowReorder:!0,style:{width:"3em"}}),s.a.createElement(W.Column,{key:"id",columnKey:"test",field:"test",editor:function(t){return e.testEditor(t)}})))),s.a.createElement(p.a,{style:{marginTop:"10px"}},s.a.createElement(v.a,{xs:"auto",style:{width:"130px"}},"\uc2dc\ud5d8\ud30c\uc77c \uc774\ub984"),s.a.createElement(v.a,{xs:"auto"},s.a.createElement("input",{style:{width:"400px"},id:"testSpecNameInput"})),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px"},onClick:this.saveClick},"\uc800\uc7a5")),s.a.createElement(v.a,{xs:"auto"},s.a.createElement(g.a,{variant:"secondary",size:"sm",style:{width:"100px"},onClick:this.testClick},"\uc7a5\ube44 \uc2dc\ud5d8")))),this.state.saveAlert&&s.a.createElement("div",{style:{position:"absolute",bottom:"50px",left:"10px",opacity:"0.95"}},s.a.createElement(f.a,{variant:this.state.saveResult?"success":"danger",onClose:function(){return e.setState({saveAlert:!1})},dismissible:!0},s.a.createElement(f.a.Heading,null,this.state.saveResult?"\ud30c\uc77c \uc800\uc7a5 \uc131\uacf5!":"\ud30c\uc77c \uc800\uc7a5 \uc2e4\ud328!"),this.state.saveErrorMessage&&s.a.createElement("p",null,this.state.saveErrorMessage),this.state.overwriteMessage&&s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,"\ub3d9\uc77c\ud55c \uc774\ub984\uc758 \uc7a5\ube44 \uaddc\uaca9 \ud30c\uc77c\uc774 \uc788\uc2b5\ub2c8\ub2e4. \ub36e\uc5b4\uc4f0\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"),s.a.createElement("hr",null),s.a.createElement("div",{className:"d-flex justify-content-end"},s.a.createElement(g.a,{style:{marginRight:"10px"},onClick:this.overwriteClick,variant:"outline-success"},"\uc608"),s.a.createElement(g.a,{onClick:function(){e.setState({saveAlert:!1,overwriteMessage:!1})},variant:"outline-danger"},"\uc544\ub2c8\uc694"))))))}}]),a}(n.Component),Y=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(m.d,null,s.a.createElement(m.b,{path:"/equip",exact:!0,component:B}),s.a.createElement(m.b,{path:"/sequence",exact:!0,component:Q}),s.a.createElement(m.a,{from:"*",to:"/equip"})))}}]),a}(n.Component),Z=a(33),ee=a(144),te=a(143),ae=function(){return s.a.createElement(ee.a,{bg:"dark",expand:"lg",variant:"dark"},s.a.createElement(ee.a.Brand,{href:"/equip"},"ETRI SmartFarm"),s.a.createElement(ee.a.Toggle,{"aria-controls":"basic-navbar-nav"}),s.a.createElement(ee.a.Collapse,{id:"basic-navbar-nav"},s.a.createElement(te.a,{className:"mr-auto"},s.a.createElement(te.a.Link,{as:Z.b,to:"/equip"},"\uc7a5\ube44 \uaddc\uaca9 \uad00\ub9ac"),s.a.createElement(te.a.Link,{as:Z.b,to:"/sequence"},"\uc2dc\ud5d8 \uaddc\uaca9 \uad00\ub9ac"))))},ne=(a(130),a(131),a(132),a(133),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return s.a.createElement(Z.a,null,s.a.createElement(s.a.Fragment,null,s.a.createElement(ae,null),s.a.createElement(Y,null)))}}]),a}(n.Component));Object.equals=function(e,t){if(e===t)return!0;if(!(e instanceof Object)||!(t instanceof Object))return!1;if(e.constructor!==t.constructor)return!1;for(var a in e)if(e.hasOwnProperty(a)){if(!t.hasOwnProperty(a))return!1;if(e[a]!==t[a]){if("object"!==typeof e[a])return!1;if(!Object.equals(e[a],t[a]))return!1}}for(a in t)if(t.hasOwnProperty(a)&&!e.hasOwnProperty(a))return!1;return!0};var se=ne;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(134);i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(se,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},82:function(e,t,a){e.exports=a(135)},87:function(e,t,a){},88:function(e,t,a){},97:function(e,t,a){}},[[82,1,2]]]);
//# sourceMappingURL=main.a570fa67.chunk.js.map